<div class="bg-gray-800 rounded-lg p-4 w-full">
  <h3 class="text-xl font-semibold text-amber-300 mb-4 text-center">Ask About This Coin</h3>
  
  <div #chatContainer class="h-64 overflow-y-auto mb-4 p-3 bg-gray-900 rounded-md space-y-4">
    @for (message of messages(); track $index) {
      <div class="flex" [class.justify-end]="message.role === 'user'">
        <div class="rounded-lg px-4 py-2 max-w-sm" [class.bg-blue-600]="message.role === 'user'" [class.bg-gray-700]="message.role === 'model'">
          <p class="text-white whitespace-pre-wrap">{{ message.text }}</p>
        </div>
      </div>
    }
    @if (isLoading() && messages().length > 0 && messages()[messages().length-1].role === 'model' && messages()[messages().length-1].text === '') {
       <div class="flex justify-start">
         <div class="rounded-lg px-4 py-2 max-w-sm bg-gray-700">
          <div class="flex items-center space-x-1">
             <span class="h-2 w-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.3s]"></span>
             <span class="h-2 w-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.15s]"></span>
             <span class="h-2 w-2 bg-gray-400 rounded-full animate-pulse"></span>
           </div>
         </div>
      </div>
    }
  </div>

  <form (submit)="sendMessage()" class="flex gap-2">
    <input 
      type="text"
      [(ngModel)]="userInput"
      name="userInput"
      placeholder="Ask a question..."
      class="flex-grow bg-gray-700 border border-gray-600 rounded-lg py-2 px-4 text-white focus:outline-none focus:ring-2 focus:ring-amber-400"
      [disabled]="isLoading()"
    >
    <button 
      type="submit" 
      class="bg-amber-500 hover:bg-amber-600 text-gray-900 font-bold py-2 px-4 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
      [disabled]="isLoading() || !userInput()">
      Send
    </button>
  </form>
</div>
